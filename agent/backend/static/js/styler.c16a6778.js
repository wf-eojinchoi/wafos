(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["styler"],{"4d3d":function(t,s,e){"use strict";var a=e("be92"),n=e.n(a);n.a},"5fbe":function(t,s,e){t.exports=e.p+"img/logo2.88467ec1.png"},"679c":function(t,s,e){t.exports=e.p+"img/card.e18f66c7.png"},"7d6e":function(t,s,e){},"9ce6":function(t,s,e){"use strict";var a=e("7d6e"),n=e.n(a);n.a},be92:function(t,s,e){},d7df:function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-stepper",{staticClass:"wt-stepper elevation-0",attrs:{"alt-labels":""},model:{value:t.steps,callback:function(s){t.steps=s},expression:"steps"}},[a("v-stepper-header",[a("v-stepper-step",{staticClass:"single-stepper",class:"ko"!=t.$i18n.locale?"title":t.$store.getters.isV2?"headline":"display-1",attrs:{complete:!0,step:"1"}},[t._v(t._s(t.$t("airdresser.step1.title")))])],1),a("v-stepper-items",[a("v-stepper-content",{attrs:{step:"1"}},[a("step1",{attrs:{course:t.course,dialog:t.dialog},on:{"update:course":function(s){t.course=s},"update:dialog":function(s){t.dialog=s}}}),a("v-layout",{attrs:{"justify-space-between":""}},[a("v-flex",{staticClass:"text-xs-center",attrs:{xs3:""}},[a("v-btn",{staticClass:"wt-prev-bg white--text wt-btn",class:t.$store.getters.isV2?"display-1":"display-2",attrs:{flat:"",round:""}},[t._v(t._s(t.$t("app.prev")))])],1),a("v-flex",{staticClass:"text-xs-center",attrs:{xs3:""}},[a("img",{staticClass:"wt-bottom-logo",attrs:{src:e("5fbe")}})]),a("v-flex",{attrs:{xs3:""}})],1)],1)],1)],1)],1),a("v-dialog",{attrs:{lazy:"",persistent:t.paymentSteps>=5},model:{value:t.dialog,callback:function(s){t.dialog=s},expression:"dialog"}},[a("v-card",{attrs:{height:"800px"}},[a("v-card-title",[a("v-spacer"),t.paymentSteps<5?a("v-btn",{attrs:{flat:"",icon:""},on:{click:function(s){return t.clearDialog()}}},[a("v-icon",{staticClass:"fa fa-times fa-4x"})],1):t._e()],1),a("v-card-text",[1===t.paymentSteps?a("v-layout",{attrs:{wrap:"","justify-center":"","align-center":"","mt-5":""}},[a("v-flex",{staticClass:"text-xs-center",attrs:{xs12:"","mt-5":""}},[a("p",[a("span",{staticClass:"display-2"},[t._v(t._s(t.$t("payment.styler")))]),a("br"),"ko"===t.$i18n.locale?a("span",{staticClass:"display-2 wt-primary-font"},[t._v(t._s(t.course.title))]):"en"===t.$i18n.locale?a("span",{staticClass:"display-2 wt-primary-font"},[t._v(t._s(t.course.title_en))]):"vi"===t.$i18n.locale?a("span",{staticClass:"display-2 wt-primary-font"},[t._v(t._s(t.course.title_vn))]):t._e(),"ko"===t.$i18n.locale?a("span",{staticClass:"display-2"},[t._v("("+t._s(t.course.description)+")")]):"en"===t.$i18n.locale?a("span",{staticClass:"display-2"},[t._v("("+t._s(t.course.description_en)+")")]):"vi"===t.$i18n.locale?a("span",{staticClass:"display-2"},[t._v("("+t._s(t.course.description_vn)+")")]):t._e(),a("br"),a("span",{staticClass:"display-2"},[t._v(t._s(t.$t("payment.desc2-3")))]),a("br"),a("br"),a("span",{directives:[{name:"show",rawName:"v-show",value:!t.canPayment(),expression:"!canPayment()"}],staticClass:"display-2 mt-5",attrs:{"mt-3":""}},[t._v('\n                "'+t._s(t.$t("payment.cant-payment"))+'"\n              ')])])]),a("v-flex",{staticClass:"text-xs-center mt-5",attrs:{xs6:""}},[a("v-btn",{staticClass:"display-2 wt-wave-bg wt-btn white--text py-5",attrs:{round:"",disabled:!t.canPayment()},on:{click:function(s){t.$store.state.user.hasOwnProperty("phone")?t.trigger():t.paymentSteps=2}}},[t.canPayment()?a("span",[t._v(t._s(t.$t("app.buy")))]):a("span",[t._v(t._s(t.$t("payment.no-payment")))])])],1)],1):2===t.paymentSteps?a("v-layout",{attrs:{wrap:"","justify-center":"","align-center":"","mt-5":""}},[a("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[a("p",[a("span",{staticClass:"display-2"},[t._v(t._s(t.$t("payment.way")))])])]),a("v-flex",{staticClass:"text-xs-center mt-5",attrs:{xs6:""}},[a("v-btn",{staticClass:"display-3 huge-btn white--text",attrs:{color:"#ea68a2",round:""},on:{click:function(s){t.paymentSteps=4,t.payment="cash"}}},[a("p",[a("img",{attrs:{src:e("e6da")}}),a("br"),a("span",[t._v(t._s(t.$t("payment.cash")))])])])],1),a("v-flex",{staticClass:"text-xs-center mt-5",attrs:{xs6:""}},[a("v-btn",{directives:[{name:"show",rawName:"v-show",value:!0===t.$store.state.agency.menu_card,expression:"$store.state.agency.menu_card === true"}],staticClass:"display-3 huge-btn white--text",attrs:{color:"#ea68a2",round:""},on:{click:function(s){t.paymentSteps=3,t.payment="card"}}},[a("p",[a("img",{attrs:{src:e("679c")}}),a("br"),a("span",[t._v(t._s(t.$t("payment.card")))])])])],1)],1):3===t.paymentSteps?a("v-layout",{attrs:{wrap:"","justify-center":"","align-center":"","mt-5":""}},[a("v-flex",{staticClass:"text-xs-center",attrs:{xs12:"","mb-5":""}},[a("p",[a("span",{staticClass:"display-2"},[t._v(t._s(t.$t("payment.desc5")))])])]),t._l(t.prices,function(s){return a("v-flex",{key:s,staticClass:"text-xs-center mt-1",attrs:{xs5:""}},[a("v-btn",{staticClass:"display-1 wt-payment-btn",attrs:{round:""},on:{click:function(e){t.paymentSteps=4,t.paymentPrice=s}}},[a("span",[t._v(t._s(s)+" "+t._s(t.$t("app.money-unit")))])])],1)})],2):4===t.paymentSteps?a("v-layout",{attrs:{wrap:"","justify-center":"","align-center":"","mt-5":""}},[a("v-flex",{staticClass:"text-xs-left",attrs:{xs8:""}},[a("span",{staticClass:"display-2"},[t._v(t._s(t.$t("payment.product-price"))+": ")]),a("span",{staticClass:"display-2 wt-primary-font"},[t._v(t._s(t.course.amount))]),a("span",{staticClass:"display-2"},[t._v(t._s(t.$t("app.money-unit")))])]),"card"===t.payment?a("v-flex",{staticClass:"text-xs-left",attrs:{xs8:"","mt-3":""}},[a("span",{staticClass:"display-2"},[t._v(t._s(t.$t("payment.payment-price"))+": ")]),a("span",{staticClass:"display-2 wt-primary-font"},[t._v(t._s(t.paymentPrice))]),a("span",{staticClass:"display-2"},[t._v(t._s(t.$t("app.point-unit")))])]):t._e(),a("v-flex",{staticClass:"text-xs-left",attrs:{xs9:"","my-2":""}},[a("v-divider")],1),a("v-flex",{staticClass:"text-xs-left",attrs:{xs8:"","mt-3":""}},[a("span",{staticClass:"display-2"},[t._v(t._s(t.$t("payment.total-saved-money"))+": ")]),a("span",{staticClass:"display-2 wt-primary-font"},[t._v("0")]),a("span",{staticClass:"display-2"},[t._v("\n              "+t._s(t.$t("app.money-unit"))+"\n              "),a("br"),t._v("\n              "+t._s(t.$t("payment.cant-save"))+"\n            ")])]),a("v-flex",{staticClass:"text-xs-center",attrs:{xs6:"","mt-4":""}},[a("v-btn",{staticClass:"display-2 wt-wave-bg wt-btn white--text py-5",attrs:{round:"",disabled:"card"===t.payment&&t.paymentPrice<t.course.amount},on:{click:function(s){t.requestPayment(),t.paymentSteps=5}}},["card"===t.payment?a("span",[t._v(t._s(t.$t("payment.card")))]):a("span",[t._v(t._s(t.$t("payment.cash")))])])],1)],1):5===t.paymentSteps?a("v-layout",{attrs:{wrap:"","justify-center":"","align-center":"","mt-5":""}},["cash"===t.payment?a("v-flex",{staticClass:"text-xs-left",attrs:{xs8:"","mt-3":""}},[a("span",{staticClass:"display-2"},[t._v(t._s(t.$t("payment.cash-warning")))])]):t._e(),a("v-flex",{staticClass:"text-xs-left",attrs:{xs8:"","mt-3":""}},[a("span",{staticClass:"display-2"},[t._v(t._s(t.$t("payment.payment-price"))+": ")]),a("span",{staticClass:"display-2 wt-primary-font"},[t._v(t._s(t.course.amount))]),a("span",{staticClass:"display-2"},[t._v(t._s(t.$t("app.money-unit")))])]),a("v-flex",{staticClass:"text-xs-left",attrs:{xs8:"","mt-3":""}},[a("span",{staticClass:"display-2"},[t._v(t._s(t.$t("payment.insert-money"))+": ")]),a("span",{staticClass:"display-2 wt-primary-font"},[t._v(t._s(t.insertMoney))]),a("span",{staticClass:"display-2"},[t._v(t._s(t.$t("app.money-unit")))])]),a("v-flex",{staticClass:"text-xs-left",attrs:{xs8:"","mt-3":""}},[a("span",{staticClass:"display-2"},[t._v(t._s(t.$t("payment.limit-time"))+": ")]),a("span",{staticClass:"display-2 wt-primary-font"},[t._v(t._s(120-t.insertCount))]),a("span",{staticClass:"display-2"},[t._v(t._s(t.$t("app.second")))])])],1):6===t.paymentSteps?a("v-layout",{attrs:{wrap:"","justify-center":"","align-center":"","mt-5":""}},[a("v-flex",{staticClass:"text-xs-center",attrs:{xs8:"","mt-3":""}},[a("span",{staticClass:"display-2"},[t._v(t._s(t.$t("payment.failure ")))])]),a("v-flex",{staticClass:"text-xs-center",attrs:{xs8:"","mt-3":""}},[a("span",{staticClass:"display-1"},[t._v(t._s(t.$t("payment.close")))])])],1):7===t.paymentSteps?a("v-layout",{attrs:{wrap:"","justify-center":"","align-center":"","mt-5":""}},[a("v-flex",{staticClass:"text-xs-center",attrs:{xs8:"","mt-3":""}},[a("span",{staticClass:"display-1"},[t._v(t._s(t.$t("payment.styler-success")))])]),a("v-flex",{staticClass:"text-xs-center",attrs:{xs8:"","mt-3":""}},[a("span",{staticClass:"display-1"},[t._v(t._s(t.$t("payment.close")))])])],1):t._e()],1)],1)],1)],1)},n=[],i=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("v-card",{staticClass:"mb-5 elevation-0",attrs:{height:"640px"}},[e("v-layout",{attrs:{wrap:"","justify-center":"","fill-height":""}},[t.hasPages()?e("v-flex",{staticClass:"text-xs-center",attrs:{xs1:"","align-self-center":""}},[e("v-btn",{attrs:{icon:"",flat:""},on:{click:function(s){return t.prevPage()}}},[e("v-icon",{staticClass:"fa fa-angle-left fa-5x"})],1)],1):t._e(),e("v-flex",{attrs:{xs10:""}},[e("v-layout",{attrs:{wrap:"","justify-center":"","align-center":""}},["ko"===t.$i18n.locale?e("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[e("span",{staticClass:"display-2 font-weight-bold wt-primary-font"},[t._v(t._s(t.$t("airdresser.step1.desc1")))]),e("span",{staticClass:"display-2"},[t._v(t._s(t.$t("airdresser.step1.desc2")))])]):e("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[e("span",{staticClass:"display-1"},[t._v(t._s(t.$t("airdresser.step1.desc1"))+" ")]),e("span",{staticClass:"display-1"},[t._v(t._s(t.$t("airdresser.step1.desc2")))])]),t._l(t.currentItems,function(s){return e("v-flex",{key:s.id,staticClass:"text-xs-center",attrs:{xs6:""}},[e("v-btn",{staticClass:"course ma-0 pa-0",class:s.id===t.course.id?"selected-course":"not-selected-course",attrs:{flat:"",top:""},on:{click:function(e){t.selectCourse(s.id)}}},[e("v-layout",{attrs:{wrap:"","ma-0":"","pa-0":""}},[e("v-flex",{attrs:{xs12:"","mt-4":""}},["ko"===t.$i18n.locale?e("span",{staticClass:"display-1"},[t._v(t._s(s.title))]):"en"===t.$i18n.locale?e("span",{staticClass:"display-1"},[t._v(t._s(s.title_en))]):"vi"===t.$i18n.locale?e("span",{staticClass:"display-1"},[t._v(t._s(s.title_vn))]):t._e()]),e("v-flex",{attrs:{xs12:"","mt-3":"","mb-2":""}},[e("span",{staticClass:"display-2"},[t._v(t._s(s.amount))])]),e("v-flex",{attrs:{xs12:"","mt-5":""}},["ko"===t.$i18n.locale?e("span",{staticClass:"headline black--text"},[t._v(t._s(s.description))]):"en"===t.$i18n.locale?e("span",{staticClass:"headline black--text"},[t._v(t._s(s.description_en))]):"vi"===t.$i18n.locale?e("span",{staticClass:"headline black--text"},[t._v(t._s(s.description_vn))]):t._e()])],1)],1)],1)})],2)],1),t.hasPages()?e("v-flex",{staticClass:"text-xs-center",attrs:{xs1:"","align-self-center":""}},[e("v-btn",{attrs:{icon:"",flat:""},on:{click:function(s){return t.nextPage()}}},[e("v-icon",{staticClass:"fa fa-angle-right fa-5x"})],1)],1):t._e()],1)],1)},r=[],c={name:"StylerStep1",props:{course:{type:Object,default:Object},dialog:{type:Boolean,default:!1}},data:function(){return{page:0,items:[]}},computed:{maxPage:function(){return this.items?parseInt(this.items.length%4===0?this.items.length/4-1:this.items.length/4):0},currentItems:function(){return this.items?this.items.slice(4*this.page,4*(this.page+1)):[]}},mounted:function(){this.$store.state.devices.tromm[0]&&(this.items=this.$store.state.devices.tromm[0].courses)},methods:{selectCourse:function(t){var s=this.items.find(function(s){return s.id===t});s&&(this.$emit("update:course",s),this.$emit("update:dialog",!0))},nextPage:function(){this.page<this.maxPage&&(this.page+=1)},prevPage:function(){this.page>0&&(this.page-=1)},hasPages:function(){return this.maxPage>0}}},l=c,o=(e("9ce6"),e("2877")),p=Object(o["a"])(l,i,r,!1,null,"223c9cda",null),m=p.exports,u={name:"Styler",components:{Step1:m},data:function(){return{course:{},steps:1,dialog:!1,payment:null,paymentSteps:1,paymentPrice:0,prices:[1e3,5e3,1e4,2e4,3e4,4e4,5e4],interval:null,insertMoney:0,insertCount:0}},destroyed:function(){this.clearDialog(),this.interval&&clearInterval(this.interval)},methods:{canPayment:function(){if(!this.$store.state.user.hasOwnProperty("phone"))return!0;if(0!==this.$store.state.agency.use_point&&this.$store.state.user.point>=this.$store.state.agency.use_point){if(this.$store.state.user.point+this.$store.state.user.money>=this.course.amount)return!0}else if(this.$store.state.user.money>=this.course.amount)return!0;return!1},trigger:function(){var t=this;if(this.$store.commit("statePause",!0),this.interval&&clearInterval(this.interval),this.insertMoney<this.paymentPrice)return this.paymentSteps=6,void setTimeout(function(){this.clearDialog()},2e3);var s=this.$store.state.devices.tromm[0].controller_id;this.$axios.post("/trigger",{price:this.course.amount,target:s}).then(function(s){if(t.$store.state.user.hasOwnProperty("phone")){var e=0,a=0;if(e=t.$store.state.user.point<t.$store.state.agency.use_point?0:t.$store.state.user.point>=t.course.amount?t.course.amount:t.$store.state.user.point,!(t.$store.state.user.money>=t.course.amount-e))return t.paymentSteps=6,void setTimeout(t.clearDialog,2e3);a=t.course.amount-e,console.log(e,a),t.$store.state.user.point-=e,t.$store.state.user.money-=a,t.$axios.post("/server",{method:"POST",path:"/payment",args:{agency_id:t.$store.state.agency.id,member_id:t.$store.state.user.id,amount:a,use_point:e,pay_type:3,device_type:2}})}else t.$axios.post("/server",{method:"POST",path:"/payment",args:{agency_id:t.$store.state.agency.id,member_id:0,amount:t.insertMoney,pay_type:"cash"===t.payment?0:2,device_type:2}});t.paymentSteps=7,setTimeout(function(){this.$router.push("/first"),this.clearDialog()}.bind(t),5e3)}).catch(function(s){t.paymentSteps=6,setTimeout(t.clearDialog,2e3)})},clearDialog:function(){this.$store.commit("stateNoAction",60),this.$store.commit("statePause",!1),this.dialog=!1,this.paymentSteps=1,this.paymentPrice=0,this.insertMoney=0,this.insertCount=0,this.useMoney=0,this.usePoint=0},requestPayment:function(){var t=this;this.$store.commit("statePause",!0),"cash"===this.payment?(this.$axios.post("/cash/call").then(function(s){t.insertMoney=s.data.money}).catch(function(s){t.interval&&clearInterval(t.interval),t.$socket.emit("cancel-payment")}),this.interval=setInterval(function(){var t=this;this.$axios.get("/cash/status").then(function(s){s.data.money>=t.course.amount?(t.trigger(),t.$socket.emit("cancel-payment")):(s.data.money&&(t.insertMoney=s.data.money),s.data.t&&(t.insertCount=s.data.t))}).catch(function(t){})}.bind(this),500)):"card"===this.payment&&(this.$axios.post("/card/call",{money:this.paymentPrice}).then(function(s){t.insertMoney=s.data.money,t.trigger()}).catch(function(t){}).finally(function(){t.interval&&clearInterval(t.interval)}),this.interval=setInterval(function(){var t=this;this.$axios.get("/card/status").then(function(s){s.data.money<t.paymentPrice&&(s.data.money&&(t.insertMoney=s.data.money),s.data.t&&(t.insertCount=s.data.t))}).catch(function(t){})}.bind(this),500))}}},y=u,v=(e("4d3d"),Object(o["a"])(y,a,n,!1,null,"0ba47f2d",null));s["default"]=v.exports},e6da:function(t,s,e){t.exports=e.p+"img/cash.b45b4be8.png"}}]);
//# sourceMappingURL=styler.c16a6778.js.map